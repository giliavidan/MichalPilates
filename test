('2026-01-11', '08:00', '09:00', 'פילאטיס מזרן קלאסי', 'Sunday', false),
('2026-01-12', '18:00', '19:00', 'פילאטיס עם כדור קטן', 'Monday', true);

-- יצירת הסכמה (בסיס הנתונים)
CREATE SCHEMA IF NOT EXISTS michal_pilates;

-- כניסה לתוך הסכמה
USE michal_pilates;

-- יצירת טבלת משתמשים
CREATE TABLE IF NOT EXISTS users (
  email VARCHAR(100) NOT NULL,
  password VARCHAR(45) NOT NULL,
  first_name VARCHAR(45) NOT NULL,
  last_name VARCHAR(45) NOT NULL,
  phone VARCHAR(20) NOT NULL,
  birthdate DATE NOT NULL,
  city VARCHAR(45) NOT NULL,
  training_habit VARCHAR(45),
  membership_type VARCHAR(45) ,
  comments TEXT,
  role VARCHAR(20) DEFAULT 'client',
  PRIMARY KEY (email)
);

INSERT INTO users (email, password, first_name, last_name, phone, birthdate, city, role) 
VALUES ('mutsnik@gmail.com', 'michal68', 'מיכל', 'אבידן', '0546202296', '1968-05-25', 'בית נקופה', 'admin');


-- יצירת טבלת שיעורים (עם המפתח המורכב שבחרנו)

CREATE TABLE classes (
  id INT AUTO_INCREMENT PRIMARY KEY,    
  class_name VARCHAR(100) NOT NULL,
  class_date DATE NOT NULL,
  day_of_week VARCHAR(20) NOT NULL,
  start_time TIME NOT NULL,
  end_time TIME NOT NULL,
  instructor VARCHAR(45) DEFAULT 'מיכל',
  zoom BOOLEAN DEFAULT false,
  max_participants INT DEFAULT 10,4
  current_participants INT DEFAULT 0,
  
  UNIQUE KEY unique_class_time (class_date, start_time) 
);

-- הכנסת נתונים לבדיקה
INSERT INTO classes (class_date, start_time, end_time, class_name, day_of_week, zoom) VALUES 


-- יצירת טבלת הודעות
CREATE TABLE IF NOT EXISTS messages (
    id INT AUTO_INCREMENT PRIMARY KEY,
    content TEXT NOT NULL,
    created_at TIMESTAMP DEFAULT CURRENT_TIMESTAMP
);


CREATE TABLE registrations (
    id INT AUTO_INCREMENT PRIMARY KEY,
    user_id VARCHAR(100) NOT NULL,
    class_id INT NOT NULL,
    status ENUM('registered', 'waitlist') NOT NULL, -- האם הוא רשום או בהמתנה
    created_at TIMESTAMP DEFAULT CURRENT_TIMESTAMP,
    
    UNIQUE KEY unique_registration (user_id, class_id),
    
    FOREIGN KEY (user_id) REFERENCES users(email) ON DELETE CASCADE,
    FOREIGN KEY (class_id) REFERENCES classes(id) ON DELETE CASCADE
);